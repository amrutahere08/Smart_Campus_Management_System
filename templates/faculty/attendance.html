{% extends "base.html" %}

{% block title %}Attendance Records - Smart Campus{% endblock %}

{% block content %}
<div class="container" style="margin-top: 2rem;">
 <!-- Header -->
 <div class="card fade-in" style="margin-bottom: 2rem;">
 <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
 <h2 style="margin: 0;"> Student Attendance Records</h2>
 <a href="{{ url_for('faculty.dashboard') }}" class="btn btn-secondary">‚Üê Back to Dashboard</a>
 </div>
 </div>

 {% if students %}
 <!-- Department Info -->
 <div class="card" style="margin-bottom: 2rem;">
 <div class="card-body">
 <p style="color: var(--text-secondary); font-size: 1.1rem;">
 Showing attendance records for <strong>{{ students|length }}</strong> students in your department
 </p>
 </div>
 </div>

 <!-- Attendance Records Table -->
 <div class="card">
 <div class="card-header">Recent Attendance Records</div>
 <div class="card-body">
 {% if attendance_records %}
 <div style="overflow-x: auto;">
 <table style="width: 100%; border-collapse: collapse;">
 <thead>
 <tr
 style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(168, 85, 247, 0.1)); border-bottom: 2px solid var(--border-color);">
 <th style="padding: 1rem; text-align: left; font-weight: 600;">Student Name</th>
 <th style="padding: 1rem; text-align: left; font-weight: 600;">Date</th>
 <th style="padding: 1rem; text-align: left; font-weight: 600;">Time</th>
 <th style="padding: 1rem; text-align: center; font-weight: 600;">Status</th>
 </tr>
 </thead>
 <tbody>
 {% for record in attendance_records %}
 <tr style="border-bottom: 1px solid var(--border-color); transition: background 0.2s ease;"
 onmouseover="this.style.background='rgba(99, 102, 241, 0.05)'"
 onmouseout="this.style.background='transparent'">
 <td style="padding: 1rem;">
 <div style="display: flex; align-items: center; gap: 0.5rem;">
 <div
 style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">
 {{ record.user.full_name[0] }}
 </div>
 <div>
 <div style="font-weight: 500;">{{ record.user.full_name }}</div>
 <div style="font-size: 0.85rem; color: var(--text-secondary);">{{
 record.user.username }}</div>
 </div>
 </div>
 </td>
 <td style="padding: 1rem; color: var(--text-secondary);">
 {{ record.timestamp.strftime('%B %d, %Y') }}
 </td>
 <td style="padding: 1rem; color: var(--text-secondary);">
 {{ record.timestamp.strftime('%I:%M %p') }}
 </td>
 <td style="padding: 1rem; text-align: center;">
 <span
 style="padding: 0.5rem 1rem; background: var(--success-color); color: white; border-radius: var(--radius-md); font-size: 0.85rem; font-weight: 500;">
 Present
 </span>
 </td>
 </tr>
 {% endfor %}
 </tbody>
 </table>
 </div>

 <!-- Summary Stats -->
 <div class="grid grid-3" style="margin-top: 2rem; gap: 1rem;">
 <div
 style="padding: 1rem; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(168, 85, 247, 0.1)); border-radius: var(--radius-md); text-align: center;">
 <div style="font-size: 2rem; font-weight: 700; color: var(--primary-color);">{{
 attendance_records|length }}</div>
 <div style="color: var(--text-secondary); font-size: 0.9rem;">Total Records</div>
 </div>
 <div
 style="padding: 1rem; background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1)); border-radius: var(--radius-md); text-align: center;">
 <div style="font-size: 2rem; font-weight: 700; color: var(--success-color);">{{ students|length }}
 </div>
 <div style="color: var(--text-secondary); font-size: 0.9rem;">Total Students</div>
 </div>
 <div
 style="padding: 1rem; background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.1)); border-radius: var(--radius-md); text-align: center;">
 <div style="font-size: 2rem; font-weight: 700; color: var(--warning-color);">{{
 ((attendance_records|length / (students|length * 30)) * 100)|round|int }}%</div>
 <div style="color: var(--text-secondary); font-size: 0.9rem;">Avg. Attendance</div>
 </div>
 </div>

 {% else %}
 <!-- No Records State -->
 <div style="text-align: center; padding: 3rem;">
 <div style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.5;"></div>
 <h3 style="color: var(--text-secondary); margin-bottom: 0.5rem;">No Attendance Records Yet</h3>
 <p style="color: var(--text-secondary);">
 Students in your department haven't marked attendance yet.
 </p>
 <p style="color: var(--text-secondary); margin-top: 1rem;">
 Students can mark attendance using the <a href="{{ url_for('common.face_recognition') }}"
 style="color: var(--primary-color);">Face Recognition</a> feature.
 </p>
 </div>
 {% endif %}
 </div>
 </div>

 {% else %}
 <!-- No Department State -->
 <div class="card">
 <div class="card-body" style="text-align: center; padding: 3rem;">
 <div style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.5;"></div>
 <h3 style="color: var(--text-secondary); margin-bottom: 0.5rem;">No Department Assigned</h3>
 <p style="color: var(--text-secondary);">
 You need to be assigned to a department to view student attendance records.
 </p>
 <p style="color: var(--text-secondary); margin-top: 1rem;">
 Please contact the administrator to assign you to a department.
 </p>
 <a href="{{ url_for('faculty.dashboard') }}" class="btn btn-primary" style="margin-top: 1.5rem;">
 Back to Dashboard
 </a>
 </div>
 </div>
 {% endif %}
</div>
{% endblock %}